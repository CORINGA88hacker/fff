<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Super Netflix de Animes</title>

<!-- SEO e compartilhamento -->
<meta name="description" content="Super Netflix de Animes - Assista animes online com temporadas e epis√≥dios legendados e dublados.">
<meta name="keywords" content="animes, assistir, online, legendado, dublado, temporadas, epis√≥dios">
<meta property="og:title" content="Super Netflix de Animes">
<meta property="og:description" content="Assista animes online com temporadas e epis√≥dios legendados e dublados.">
<meta property="og:image" content="https://via.placeholder.com/200x300?text=Super+Netflix+de+Animes">
<meta property="og:type" content="website">
<meta name="theme-color" content="#e50914">
<link rel="icon" href="favicon.ico" type="image/x-icon">

<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">

<style>
body { font-family: 'Open Sans', sans-serif; background: #141414; color: #fff; margin: 0; }
header { text-align: center; padding: 20px; background: linear-gradient(to bottom, #000, transparent); }
header h1 { font-family: 'Bebas Neue', sans-serif; font-size: 48px; color: #e50914; letter-spacing: 2px; }

#search-container { text-align: center; margin: 20px; }
#search-input { padding: 10px; font-size: 16px; width: 250px; border-radius: 4px; border: none; }
button { padding: 10px 15px; font-size: 16px; margin-left: 5px; cursor: pointer; background: #e50914; color: #fff; border: none; border-radius: 4px; transition: .3s; }
button:hover { background: #f40612; }
#counter { text-align: center; margin-bottom: 20px; font-size: 18px; font-weight: bold; }

/* Loader */
#loading { text-align: center; padding: 20px; }
.loader {
  border: 6px solid #222;
  border-top: 6px solid #e50914;
  border-radius: 50%;
  width: 40px; height: 40px;
  animation: spin 0.8s linear infinite;
  margin: auto;
}
@keyframes spin { 100% { transform: rotate(360deg); } }

.anime-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 15px; padding: 20px; }
.anime-card { background: #181818; border-radius: 8px; cursor: pointer; transition: transform .3s, box-shadow .3s; }
.anime-card:hover { transform: scale(1.08); box-shadow: 0 0 20px rgba(255,0,0,0.5); }
.anime-card img { width: 100%; height: 270px; object-fit: cover; border-radius: 8px 8px 0 0; }
.anime-card h2 { font-family: 'Bebas Neue', sans-serif; margin: 10px; font-size: 18px; color: #fff; }
.anime-card p { font-size: 13px; margin: 5px 10px; color: #aaa; }

dialog { background: #181818; color: #fff; border: none; border-radius: 10px; padding: 20px; width: 90%; max-width: 800px; }
dialog::backdrop { background: rgba(0,0,0,0.85); }
#dialog-header { display: flex; gap: 20px; flex-wrap: wrap; }
#dialog-header img { width: 200px; border-radius: 5px; }
#dialog-info { flex: 1; }
#dialog-info h2 { font-family: 'Bebas Neue', sans-serif; font-size: 30px; color: #e50914; margin: 0; }
#dialog-info p { color: #ddd; font-size: 14px; margin: 8px 0; }
#episode-list { margin-top: 20px; padding: 0; }
#episode-list details { background: #222; margin-bottom: 8px; border-radius: 6px; padding: 6px; }
#episode-list summary { cursor: pointer; font-weight: bold; }
#episode-list li { padding: 5px 15px; font-size: 14px; }
#episode-list li a { color: #fff; text-decoration: none; }
#episode-list li a:hover { text-decoration: underline; }
form[method="dialog"] { margin-top: 15px; text-align: right; }

/* Bot√µes copiar */
#copy-container { margin-top: 15px; text-align: right; }
#copy-container button { background: #333; margin-left: 5px; }
#copy-container button:hover { background: #444; }

/* Toast */
#toast {
  position: fixed; bottom: 20px; right: 20px;
  background: #333; color: #fff;
  padding: 10px 15px; border-radius: 6px;
  opacity: 0; transition: opacity .4s;
}
#toast.show { opacity: 1; }

/* Responsivo */
@media (max-width: 600px) {
  #dialog-header { flex-direction: column; align-items: center; }
  #dialog-header img { width: 150px; }
}
</style>
</head>
<body>

<header><h1>Lista de Animes</h1></header>

<section id="search-container">
  <input type="text" id="search-input" placeholder="Pesquisar por ID ou nome do anime..." aria-label="Pesquisar anime">
  <button id="clear-btn" aria-label="Limpar busca">Limpar</button>
</section>

<div id="counter"></div>
<div id="loading"><div class="loader"></div></div>
<section id="anime-list" class="anime-list"></section>

<dialog id="anime-dialog" role="dialog" aria-labelledby="modal-title" aria-describedby="modal-desc">
  <div id="dialog-header">
    <img id="dialog-capa" src="" alt="Capa do anime">
    <div id="dialog-info">
      <h2 id="modal-title"></h2>
      <p id="modal-desc"></p>
      <p id="modal-year"></p>
      <p id="modal-season-count"></p>
      <p id="modal-ep-count"></p>
    </div>
  </div>

  <!-- Bot√µes copiar -->
  <div id="copy-container">
    <button id="copy-name" aria-label="Copiar nome do anime">üìã Copiar Nome</button>
    <button id="copy-id" aria-label="Copiar ID do anime">üìã Copiar ID</button>
  </div>

  <ul id="episode-list"></ul>
  <form method="dialog"><button>Fechar</button></form>
</dialog>

<div id="toast"></div>

<script>
const animeListEl = document.getElementById('anime-list');
const counterEl = document.getElementById('counter');
const loadingEl = document.getElementById('loading');
const searchInput = document.getElementById('search-input');
const clearBtn = document.getElementById('clear-btn');
const dialog = document.getElementById('anime-dialog');
const modalTitle = document.getElementById('modal-title');
const modalDesc = document.getElementById('modal-desc');
const modalYear = document.getElementById('modal-year');
const modalSeasonCount = document.getElementById('modal-season-count');
const modalEpCount = document.getElementById('modal-ep-count');
const dialogCapa = document.getElementById('dialog-capa');
const episodeList = document.getElementById('episode-list');
const copyNameBtn = document.getElementById('copy-name');
const copyIdBtn = document.getElementById('copy-id');
const toast = document.getElementById('toast');

let animes = [];
let episodios = [];
let temporadas = [];
let animeAtual = null; // anime atual do modal

async function carregarDados() {
  loadingEl.style.display = 'block';
  try {
    const [resA, resE, resT] = await Promise.all([
      fetch('https://anime-aniverso.vercel.app/animes.json'),
      fetch('https://anime-aniverso.vercel.app/episodios.json'),
      fetch('https://anime-aniverso.vercel.app/temporadas.json')
    ]);
    animes = await resA.json();
    episodios = await resE.json();
    temporadas = await resT.json();
    exibirAnimes(animes);
  } catch (err) {
    console.error('Erro ao carregar dados:', err);
    animeListEl.innerHTML = `
      <p style="text-align:center">‚ùå N√£o foi poss√≠vel carregar os animes.</p>
      <div style="text-align:center"><button onclick="carregarDados()">üîÑ Tentar novamente</button></div>
    `;
  } finally {
    loadingEl.style.display = 'none';
  }
}

function exibirAnimes(lista) {
  animeListEl.innerHTML = '';
  if (lista.length === 0) {
    animeListEl.innerHTML = `<p style="text-align:center">‚ö† Nenhum anime encontrado.</p>`;
    counterEl.textContent = "Total: 0 animes";
    return;
  }
  lista.forEach(anime => {
    const card = document.createElement('div');
    card.className = 'anime-card';
    card.innerHTML = `
      <img loading="lazy" src="${anime.capa || 'https://via.placeholder.com/200x300?text=Sem+Capa'}" alt="${anime.nome || 'Capa indispon√≠vel'}">
      <h2>${anime.nome || 'Sem t√≠tulo'}</h2>
      <p>ID: ${anime.id || 'N√£o dispon√≠vel'}</p>
      <p>${anime.ano || 'Ano desconhecido'}</p>`;
    card.addEventListener('click', () => abrirDialogo(anime));
    animeListEl.appendChild(card);
  });
  counterEl.textContent = `Total: ${lista.length} animes`;
}

function abrirDialogo(anime) {
  animeAtual = anime;
  modalTitle.textContent = anime.nome || 'Sem t√≠tulo';
  modalDesc.textContent = anime.descricao || 'Sem descri√ß√£o';
  modalYear.textContent = `Ano: ${anime.ano || 'Desconhecido'}`;
  dialogCapa.src = anime.capa || 'https://via.placeholder.com/200x300?text=Sem+Capa';
  dialogCapa.alt = `Capa do anime ${anime.nome || 'desconhecido'}`;

  const seas = temporadas.filter(s => String(s.anime_id) === String(anime.id));
  modalSeasonCount.textContent = `Temporadas: ${seas.length}`;

  episodeList.innerHTML = '';
  let totalEps = 0;

  seas.forEach(season => {
    const details = document.createElement('details');
    const summary = document.createElement('summary');
    summary.textContent = `${season.nome || `Temporada ${season.numero || '?'}`} (${season.total_episodios || 0} epis√≥dios)`;
    details.appendChild(summary);

    const eps = episodios.filter(ep => String(ep.temporada_id) === String(season.id));
    totalEps += eps.length;

    if (eps.length === 0) {
      const li = document.createElement('li');
      li.textContent = 'Sem epis√≥dios dispon√≠veis';
      details.appendChild(li);
    } else {
      eps.forEach(ep => {
        const epNome = ep.nome || ep.titulo || 'Epis√≥dio sem t√≠tulo';
        let links = [];
        if (ep.legendado) links.push(`<a href="${ep.legendado}" target="_blank">Legendado</a>`);
        if (ep.dublado) links.push(`<a href="${ep.dublado}" target="_blank">Dublado</a>`);

        const li = document.createElement('li');
        li.innerHTML = `${epNome} ${links.length ? '(' + links.join(' | ') + ')' : ''}`;
        details.appendChild(li);
      });
    }
    episodeList.appendChild(details);
  });

  modalEpCount.textContent = `Epis√≥dios: ${totalEps}`;
  dialog.showModal();
}

// Fechar modal clicando fora
dialog.addEventListener('click', e => {
  if (e.target === dialog) dialog.close();
});

// Fechar modal com ESC
document.addEventListener('keydown', e => {
  if (e.key === 'Escape' && dialog.open) dialog.close();
});

// Busca em tempo real
function normalizarTexto(texto) {
  return texto ? texto.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase() : "";
}
searchInput.addEventListener('input', () => {
  const termo = normalizarTexto(searchInput.value.trim());
  if (!termo) {
    exibirAnimes(animes);
    return;
  }
  const resultado = animes.filter(a =>
    String(a.id).includes(termo) ||
    normalizarTexto(a.nome)?.includes(termo)
  );
  exibirAnimes(resultado);
});

clearBtn.addEventListener('click', () => {
  searchInput.value = '';
  exibirAnimes(animes);
});

// Copiar com toast
function mostrarToast(msg) {
  toast.textContent = msg;
  toast.className = "show";
  setTimeout(() => toast.className = "", 2000);
}

copyNameBtn.addEventListener('click', () => {
  if (animeAtual) {
    navigator.clipboard.writeText(animeAtual.nome || "Sem t√≠tulo").then(() => {
      mostrarToast("‚úÖ Nome copiado!");
    });
  }
});
copyIdBtn.addEventListener('click', () => {
  if (animeAtual) {
    navigator.clipboard.writeText(animeAtual.id || "Sem ID").then(() => {
      mostrarToast("‚úÖ ID copiado!");
    });
  }
});

carregarDados();
</script>
</body>
</html>
